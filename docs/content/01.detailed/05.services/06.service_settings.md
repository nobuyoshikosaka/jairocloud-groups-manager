---
title: services.service_settings
description: 当システムの動的なサービス設定情報の保存および取得を行う機能を提供する。
---

## get_client_credentials
データベースから当システムに紐づく SP のクライアント認証情報を取得する機能を提供する。

#### シグネチャ
```python[service_settings.py]
def get_client_credentials() -> ClientCredentials | None:
```

#### 戻り値

| 型                                                                       | 説明                                                 |
| ------------------------------------------------------------------------ | ---------------------------------------------------- |
| [ClientCredentials](../03.entities/07.auth.md#clientcredentials) \| None | クライアント認証情報。存在しない場合は None を返す。 |

#### エラー

| エラー名                                                        | 説明                                                       |
| --------------------------------------------------------------- | ---------------------------------------------------------- |
| [DatabaseError](../02.foundation/07.exc.md#databaseerror)       | データベース操作で予期しないエラーが発生した場合。         |
| [CredentialsError](../02.foundation/07.exc.md#credentialserror) | 取得された設定からクライアント認証情報を読み取れない場合。 |

#### 処理内容
1. データベースからサービス設定情報を `client_credentials` キーで取得する。
2. レコードが存在しない場合は `None` を戻り値として返す。
3. データベース操作中に予期しないエラーが発生した場合は [DatabaseError](../02.foundation/07.exc.md#databaseerror) を送出する。
4. 取得した設定情報を [ClientCredentials](../03.entities/07.auth.md#clientcredentials) モデルにデシリアライズして戻り値として返す。
5. デシリアライズに失敗した場合は [CredentialsError](../02.foundation/07.exc.md#credentialserror) を送出する。


## save_client_credentials
当システムに紐づく SP のクライアント認証情報をデータベースに保存する機能を提供する。

#### シグネチャ
```python[service_settings.py]
def save_client_credentials(credentials: ClientCredentials) -> None:
```

#### 引数

| 名前        | 型                                                               | 説明 |
| ----------- | ---------------------------------------------------------------- | ---- |
| credentials | [ClientCredentials](../03.entities/07.auth.md#clientcredentials) |      | クライアント認証情報 |

#### エラー

| エラー名                                                        | 説明                                               |
| --------------------------------------------------------------- | -------------------------------------------------- |
| [DatabaseError](../02.foundation/07.exc.md#databaseerror)       | データベース操作で予期しないエラーが発生した場合。 |
| [CredentialsError](../02.foundation/07.exc.md#credentialserror) | クライアント認証情報のシリアライズに失敗した場合。 |

#### 処理内容
1. 引数 `credentials` を JSON データにシリアライズする。
2. シリアライズに失敗した場合は [CredentialsError](../02.foundation/07.exc.md#credentialserror) を送出する。
3. データベースにサービス設定情報を `client_credentials` キーで保存する。
4. データベース操作中に予期しないエラーが発生した場合は [DatabaseError](../02.foundation/07.exc.md#databaseerror) を送出する。
